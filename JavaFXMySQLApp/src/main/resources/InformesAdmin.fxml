<?xml version="1.0" encoding="UTF-8"?>

<?import java.net.*?>
<?import javafx.geometry.*?>
<?import javafx.scene.chart.*?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<VBox prefHeight="750.0" prefWidth="1200.0" styleClass="background-panel" xmlns="http://javafx.com/javafx/17.0.12" xmlns:fx="http://javafx.com/fxml/1" fx:controller="app.controller.InformesController">
    <stylesheets>
        <URL value="@style.css" />
    </stylesheets>
    <children>
        <!-- Título Superior -->
        <Label alignment="CENTER" contentDisplay="CENTER" maxWidth="Infinity" prefHeight="70.0" prefWidth="1200.0" styleClass="titulo-principal" text="Informes y Estadísticas del Sistema" HBox.hgrow="ALWAYS">
            <VBox.vgrow>NEVER</VBox.vgrow>
        </Label>

        <!-- Contenido Dividido (Área de Estadísticas) -->
        <HBox VBox.vgrow="ALWAYS">
            <VBox fx:id="panelEstadisticas" prefHeight="754.0" prefWidth="1200.0" spacing="15.0" HBox.hgrow="ALWAYS">
                <padding>
                    <Insets bottom="15.0" left="15.0" right="15.0" top="15.0" />
                </padding>
                <children>
                    <!-- Fila Superior: LineChart y Métricas Clave -->
                    <HBox alignment="TOP_LEFT" spacing="15.0" VBox.vgrow="ALWAYS">

                        <!-- LineChart (Tendencia de Ventas) -->
                        <VBox alignment="CENTER" prefHeight="77.0" prefWidth="664.0" spacing="10.0" style="-fx-background-color: #8A8A8A; -fx-background-radius: 8;" HBox.hgrow="ALWAYS">
                            <padding>
                                <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                            </padding>
                            <Label style="-fx-text-fill: white;" styleClass="subtitulo" text="Ventas por Período">
                        <font>
                           <Font name="System Bold" size="30.0" />
                        </font></Label>
                            <HBox alignment="CENTER" spacing="20.0">
                                <DatePicker fx:id="dpFechaInicio" />
                                <DatePicker fx:id="dpFechaFin" />
                                <Button mnemonicParsing="false" onAction="#handleGenerarGraficoButton" style="-fx-background-color: #7f5af0; -fx-text-fill: white; -fx-background-radius: 5; -fx-font-weight: bold; -fx-padding: 8 15;" text="Generar Gráfico" />
                            </HBox>
                            <LineChart fx:id="lineChartVentas" prefHeight="250.0" prefWidth="550.0" style="-fx-title-fill: white; -fx-legend-fill: white;" title="Tendencia de Ventas">
                                <xAxis>
                                    <CategoryAxis label="Día" style="-fx-tick-label-fill: white; -fx-text-fill: white; -fx-label-fill: white;" fx:id="xAxisVentas" />
                                </xAxis>
                                <yAxis>
                                    <NumberAxis fx:id="yAxisVentas" label="Monto ($)" style="-fx-tick-label-fill: white; -fx-text-fill: white; -fx-label-fill: white;" />
                                </yAxis>
                            </LineChart>
                        </VBox>

                        <!-- Panel de Métricas Clave -->
                        <VBox alignment="CENTER" prefHeight="350.0" prefWidth="350.0" spacing="15.0" style="-fx-background-color: #8A8A8A; -fx-background-radius: 8;" HBox.hgrow="ALWAYS">
                            <padding>
                                <Insets bottom="10.0" left="20.0" right="20.0" top="20.0" />
                            </padding>
                            <Label prefHeight="36.0" prefWidth="180.0" style="-fx-text-fill: white;" styleClass="subtitulo" text="Métricas Clave">
                        <font>
                           <Font name="System Bold" size="25.0" />
                        </font></Label>

                            <VBox alignment="CENTER_LEFT" spacing="10.0">
                                <Label style="-fx-text-fill: white;" styleClass="metric-label" text="Total de Ventas:">
                                    <font><Font size="16.0" /></font>
                                </Label>
                                <Label fx:id="lblTotalVentas" style="-fx-text-fill: white;" styleClass="metric-value" text="\$ 0.00">
                                    <font><Font name="System Bold" size="28.0" /></font>
                                </Label>
                            </VBox>
                            <VBox alignment="CENTER_LEFT" prefHeight="117.0" prefWidth="380.0" spacing="10.0">
                                <Label style="-fx-text-fill: white;" styleClass="metric-label" text="Facturas Emitidas en Total:">
                                    <font><Font size="16.0" /></font>
                                </Label>
                                <Label fx:id="lblFacturasEmitidas" style="-fx-text-fill: white;" styleClass="metric-value" text="0">
                                    <font><Font name="System Bold" size="28.0" /></font>
                                </Label>
                            </VBox>

                            <!-- NUEVA SECCIÓN: Facturas por Empleado -->
                            <VBox alignment="CENTER_LEFT" prefHeight="139.0" prefWidth="380.0" spacing="10.0" VBox.vgrow="ALWAYS">
                                <children>
                                    <Label style="-fx-text-fill: white;" styleClass="metric-label" text="Facturas Emitidas Por:">
                                        <font><Font size="16.0" /></font>
                                    </Label>
                                    <!-- ChoiceBox para seleccionar al empleado -->
                                    <ChoiceBox fx:id="cbEmpleado" maxWidth="Infinity" />
                                    <!-- Label para el contador de facturas del empleado -->
                                    <Label fx:id="lblFacturasEmpleado" style="-fx-text-fill: white;" styleClass="metric-value" text="0">
                                        <font><Font name="System Bold" size="28.0" /></font>
                                    </Label>
                                </children>
                            </VBox>
                        </VBox>
                    </HBox>

                    <!-- Fila Inferior: PieChart y BarChart lado a lado -->
                    <HBox alignment="TOP_LEFT" spacing="15.0" VBox.vgrow="ALWAYS">
                        <!-- PieChart para Distribución -->
                        <VBox alignment="CENTER" prefHeight="352.0" prefWidth="507.0" style="-fx-background-color: #8A8A8A; -fx-background-radius: 8;" HBox.hgrow="ALWAYS">
                            <children>
                                <Label style="-fx-text-fill: white;" styleClass="subtitulo" text="Distribución de Ingresos">
                           <font>
                              <Font name="System Bold" size="25.0" />
                           </font></Label>
                                <PieChart fx:id="pieChartVentas" prefHeight="275.0" prefWidth="577.0" style="-fx-title-fill: white; -fx-legend-fill: white;" title="Distribución" />
                            </children>
                        </VBox>

                        <!-- BarChart para Comparación de Categorías -->
                        <VBox alignment="CENTER" prefHeight="302.0" prefWidth="918.0" style="-fx-background-color: #8A8A8A; -fx-background-radius: 8;" HBox.hgrow="ALWAYS">
                            <children>
                                <Label style="-fx-text-fill: white;" styleClass="subtitulo" text="Ventas por Categoría de Producto">
                           <font>
                              <Font name="System Bold" size="22.0" />
                           </font></Label>
                                <BarChart fx:id="barChartCategorias" prefHeight="301.0" prefWidth="577.0" style="-fx-title-fill: white; -fx-legend-fill: white;" title="Volumen por Categoría">
                                    <xAxis>
                                        <CategoryAxis label="Categoría" side="BOTTOM" style="-fx-tick-label-fill: white; -fx-text-fill: white; -fx-label-fill: white;" fx:id="xAxisCategorias" />
                                    </xAxis>
                                    <yAxis>
                                        <NumberAxis fx:id="yAxisUnidades" label="Unidades Vendidas" side="LEFT" style="-fx-tick-label-fill: white; -fx-text-fill: white; -fx-label-fill: white;" />
                                    </yAxis>
                                </BarChart>
                            </children>
                        </VBox>
                    </HBox>
                    <Button fx:id="btnVolver" alignment="CENTER" mnemonicParsing="false" onAction="#handleVolverButtonInformes" prefHeight="35.0" prefWidth="100.0" styleClass="button-volver" text="Volver" />
                </children>
            </VBox>
        </HBox>
    </children>


</VBox>
